# TabFlow 扩展测试指南

## 测试步骤

### 1. 图标测试
- [x] 检查 `icons/` 目录下是否有新的图标文件
- [x] 图标尺寸：16x16, 48x48, 128x128
- [x] 图标设计：现代化渐变设计，包含标签页卡片元素

### 2. 安装扩展
1. 打开 Chrome 浏览器
2. 进入 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `/Users/apple/chromeEx` 目录

### 3. 功能测试

#### 3.1 基本分组功能
1. 打开多个相同域名的标签页（如：github.com, google.com）
2. 点击扩展图标
3. 点击"🏷️ 重新整理分组"按钮
4. 检查标签页是否按域名分组

#### 3.2 实时数量更新测试
1. 创建一个分组后，观察分组标题中的数量
2. 在同一域名下打开新标签页
3. **关键测试**：检查分组标题中的数量是否实时更新
4. 关闭分组中的某个标签页
5. **关键测试**：检查分组标题中的数量是否减少

#### 3.3 扩展界面测试
1. 点击扩展图标打开弹窗
2. 检查统计信息是否正确显示
3. 点击"🔄 刷新分类"按钮
4. 检查域名列表是否正确显示

### 4. 预期结果

#### 图标显示
- ✅ 扩展图标应显示为现代化的渐变设计
- ✅ 图标包含多个标签页卡片和流动箭头元素

#### 数量更新功能
- ✅ 分组标题格式：`域名 (数量)`
- ✅ 当添加标签页时，括号内数量应立即增加
- ✅ 当关闭标签页时，括号内数量应立即减少
- ✅ 数量应始终反映分组中的实际标签页数量

#### 性能优化
- ✅ 扩展响应速度快
- ✅ 不会造成浏览器卡顿
- ✅ 内存使用合理

## 修复的问题

### 1. 图标问题
- **问题**：原图标设计较为简单
- **解决**：创建了现代化渐变设计的图标，包含：
  - 蓝紫色到粉色的渐变背景
  - 多层标签页卡片效果
  - 流动箭头指示
  - 装饰性元素

### 2. 数量显示问题
- **问题**：分组标题中的标签页数量不能实时更新
- **解决**：
  - 修复了 `autoGroupTabsByDomain` 函数中的数量计算逻辑
  - 添加了 `chrome.tabs.onRemoved` 监听器
  - 添加了 `chrome.tabs.onAttached` 监听器
  - 添加了定期更新机制（每5秒检查一次）
  - 确保分组标题始终显示正确的标签页数量

## 技术改进

1. **实时监听**：添加了多个事件监听器确保数量实时更新
2. **防抖处理**：避免频繁更新造成性能问题
3. **错误处理**：增加了 try-catch 块处理异常情况
4. **缓存优化**：使用缓存减少重复查询
5. **定期同步**：定时器确保数据一致性